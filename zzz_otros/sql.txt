-- Crear base de datos
CREATE DATABASE IF NOT EXISTS cafeteria;
USE cafeteria;

-- Tabla de usuarios (sin hash aún)
CREATE TABLE usuarios (
    id INT AUTO_INCREMENT PRIMARY KEY,
    nombre VARCHAR(100) NOT NULL,
    email VARCHAR(100) NOT NULL UNIQUE,
    password VARCHAR(100) NOT NULL,
    rol ENUM('admin', 'vendedor') NOT NULL DEFAULT 'vendedor'
);

-- Tabla de productos
CREATE TABLE productos (
    id INT AUTO_INCREMENT PRIMARY KEY,
    nombre VARCHAR(100) NOT NULL,
    referencia VARCHAR(100) NOT NULL,
    precio INT NOT NULL,
    peso INT NOT NULL,
    categoria VARCHAR(100) NOT NULL,
    stock INT NOT NULL,
    fecha_creacion DATE NOT NULL
);

-- Tabla de ventas
CREATE TABLE ventas (
    id INT AUTO_INCREMENT PRIMARY KEY,
    producto_id INT NOT NULL,
    cantidad INT NOT NULL,
    fecha_venta DATE NOT NULL,
    FOREIGN KEY (producto_id) REFERENCES productos(id) ON DELETE CASCADE
);

-- Consultas sugeridas (como comentarios para pruebas futuras)

-- -- Producto con mayor stock:
-- SELECT * FROM productos ORDER BY stock DESC LIMIT 1;

-- -- Producto más vendido:
-- SELECT p.id, p.nombre, SUM(v.cantidad) AS total_vendido
-- FROM productos p
-- JOIN ventas v ON p.id = v.producto_id
-- GROUP BY p.id, p.nombre
-- ORDER BY total_vendido DESC
-- LIMIT 1;
